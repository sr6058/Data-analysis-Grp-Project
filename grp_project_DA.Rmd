


knitr::opts_chunk$set(echo = TRUE)
setwd("C:/Users/hp/Desktop/DA grp project")
library(tidyverse)
library(stargazer)
library(gt)
library(dplyr)
educ <- read.csv("sect2_education.csv", na.strings = " ")
health<-read.csv("sect3_health.csv", na.strings = " ")
remittances<-read.csv("sect5_remittances.csv", na.strings = " ")
roster<-read.csv("sect1_roster.csv", na.strings = " ")
labour <- read.csv("sect4a1_labour.csv", na.strings = " ")




Merging datasets


neduc <- subset(educ, select=c("hhid", "zone","lga", "state", "sector", "indiv" ,"ea", "s02q08"))
nhealth <- subset(health, select=c("hhid", "zone","lga", "state", "sector", "indiv" ,"ea", "s03q24"))
nlabour <- subset(labour, select=c("hhid", "zone","lga", "state", "sector", "indiv" ,"ea", "s04aq05", "s04aq12"))
nremittances <- subset(remittances, select=c("hhid", "zone","lga", "state", "sector", "indiv" ,"ea", "s05q02b", "s05q02a") )
nroster <- subset(roster, select=c("hhid", "zone","lga", "state", "sector", "indiv" ,"ea", "s01q02"))

#Merging variables in one dataset
merged_data <- inner_join(neduc, nhealth,by=c('hhid', 'zone',
                            'lga', 'state', 'sector', 'indiv' ,'ea') ) %>% 
  inner_join(nlabour,by=c('hhid', 'zone',
                            'lga', 'state', 'sector', 'indiv' ,'ea') ) %>%  
  inner_join(nremittances, by=c('hhid', 'zone',
                            'lga', 'state', 'sector', 'indiv' ,'ea') ) %>% 
  inner_join(nroster, by=c('hhid', 'zone',
                            'lga', 'state', 'sector', 'indiv' ,'ea') ) 





#Ruqi's code
#Merge Dataset Per Joint Unique Identifiers

#please note this is not adjusted to a certain hh or indiv level.
nEducation<-subset(Education, select = c( 'hhid','zone','lga', 'state', 'sector', 'indiv' ,'ea','s02q08'))
nRemittances<-subset(Remittances, select = c('hhid', 'zone','lga', 'state', 'sector', 'indiv' ,'ea','s05q02a'))
nRoster<-subset(Roster, select = c('hhid','zone','lga', 'state', 'sector', 'indiv' ,'ea','s01q02'))
nHealth<-subset(Health, select = c( 'hhid','zone','lga', 'state', 'sector', 'indiv' ,'ea','s03q24'))

#Merging Existin Datasets using Merge()
merge_data <- merge(nEducation, nHealth, by=c( 'hhid','zone',
                            'lga', 'state', 'sector', 'indiv' ,'ea'), all=TRUE)

merge_data <- merge(merge_data, nRemittances, by=c('hhid','zone',
                            'lga', 'state', 'sector', 'indiv' ,'ea'), all=TRUE)

merge_data <- merge(merge_data, nRoster, by=c( 'hhid','zone',
                            'lga', 'state', 'sector', 'indiv' ,'ea'), all=TRUE)
#Rename the Columns on the Merged Data Set
merge_data <- merge_data %>% 
    rename(education=s02q08, health=s03q24, remittances=s05q02a,roster=s01q02)

#Cleaning missing Values from the data set
 merge_data_drop <- merge_data %>% drop_na(education, health, remittances, roster)
 




